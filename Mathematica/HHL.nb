(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46251,       1276]
NotebookOptionsPosition[     42334,       1195]
NotebookOutlinePosition[     42734,       1211]
CellTagsIndexPosition[     42691,       1208]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Verifying HHL", "Title",ExpressionUUID->"c6575417-f821-4098-9059-ae47604f6e12"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<DiracDec\>\""}], 
      "}"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Get", "[", "\"\<DiracAll`\>\"", "]"}]}], "Code",
 CellLabel->"In[3]:=",ExpressionUUID->"cdcd0075-d750-441f-83d0-24537a94534c"],

Cell["start timing", "Text",ExpressionUUID->"ded6d6f1-e910-48d3-88d6-cda40782a4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"startTime", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"cfd78e22-c41f-485f-94ae-081624387523"],

Cell[CellGroupData[{

Cell["Eq1", "Subsection",ExpressionUUID->"cbbcd56c-6a36-4942-934f-dc466215fb89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"DiracCtx", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "->", "T"}], ",", 
       RowBox[{"b", "->", "T"}], ",", 
       RowBox[{
        RowBox[{"U", "[", "_", "]"}], "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "\[CircleTimes]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"U", "[", "b", "]"}], "\[SmallCircle]", 
          TemplateBox[{"0"},
           "Ket"]}], ")"}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"b"},
         "Ket"]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], ",", "\[IndentingNewLine]", "False", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"U", "[", "b_", "]"}], "~", "MLTK", "~", 
        RowBox[{"KET", "[", "0", "]"}]}], "->", 
       RowBox[{"KET", "[", "b", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"4ba4b617-838d-4ef4-bd56-d0434b6cf47f"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",ExpressionUUID->"e051a325-d536-4547-85b8-0c141467b3b0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq2", "Subsection",ExpressionUUID->"5a808bf5-f7a0-4088-97c6-9bd8353724e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"DiracCtx", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "->", "T"}], ",", 
       RowBox[{"b", "->", "T"}], ",", 
       RowBox[{
        RowBox[{"U", "[", "_", "]"}], "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", 
       RowBox[{"Hn", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Hn", "\[SmallCircle]", 
          TemplateBox[{"0"},
           "Ket"]}], ")"}], "\[CircleTimes]", 
        TemplateBox[{"b"},
         "Ket"]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CPX", "[", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "]"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Tau]"},
            "Ket"], "\[CircleTimes]", 
           TemplateBox[{"b"},
            "Ket"]}], ")"}], "\[CircleTimes]", 
         TemplateBox[{"0"},
          "Ket"]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", 
          RowBox[{"USET", "[", 
           RowBox[{"Fin", "[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hn", "~", "MLTK", "~", 
        RowBox[{"KET", "[", "0", "]"}]}], ":>", 
       RowBox[{
        RowBox[{"CPX", "[", 
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"n", "+", "1"}], "]"}]}], "]"}], "~", "SCRK", "~", 
        RowBox[{"SUMK", "[", 
         RowBox[{"\[Tau]", ",", 
          RowBox[{"USET", "[", 
           RowBox[{"Fin", "[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"KET", "[", "\[Tau]", "]"}]}], "]"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"0d43fb5d-cf52-420a-a9e5-a8347b3271f8"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"abab414e-1a8a-4a6f-b47a-f5b69476a8d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq3", "Subsection",ExpressionUUID->"37a7088d-33fc-488d-8a2f-1a66e5d6c7a5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DiracCtx", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "->", "T"}], ",", 
        RowBox[{"M", "->", 
         RowBox[{"SetType", "[", "m", "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Beta]", "[", "_", "]"}], "->", "SType"}], ",", 
        RowBox[{"b", "->", "T"}], ",", 
        RowBox[{
         RowBox[{"u", "[", "_", "]"}], "->", 
         RowBox[{"KType", "[", "T", "]"}]}], ",", 
        RowBox[{
         RowBox[{"U", "[", "_", "]"}], "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", 
        RowBox[{"Hu", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
        RowBox[{"Uf", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
           RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Uf", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"i"},
            "Ket"], "\[CircleTimes]", 
           TemplateBox[{"i"},
            "Bra"]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CPX", "[", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "i", " ", 
                RowBox[{"\[Lambda]", "[", "j", "]"}], " ", 
                RowBox[{
                 RowBox[{"t0", "[", "j", "]"}], " ", "/", " ", 
                 RowBox[{"(", 
                  RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
               RowBox[{"(", 
                SuperscriptBox[
                 RowBox[{"u", "[", "j", "]"}], "\[Dagger]"], ")"}]}], ")"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CPX", "[", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "]"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Uf", "\[SmallCircle]", 
           RowBox[{"(", 
            RowBox[{
             TemplateBox[{"\[Tau]"},
              "Ket"], "\[CircleTimes]", 
             TemplateBox[{"b"},
              "Ket"]}], ")"}]}], ")"}], "\[CircleTimes]", 
         TemplateBox[{"0"},
          "Ket"]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", 
          RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CPX", "[", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "]"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Beta]", "[", "j", "]"}], 
              RowBox[{"CPX", "[", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "\[Tau]", " ", 
                 RowBox[{"\[Lambda]", "[", "j", "]"}], " ", 
                 RowBox[{
                  RowBox[{"t0", "[", "j", "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
              TemplateBox[{"\[Tau]"},
               "Ket"]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Tau]", ",", 
               RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], 
           "\[CircleTimes]", 
           RowBox[{"u", "[", "j", "]"}]}], ")"}], "\[CircleTimes]", 
         TemplateBox[{"0"},
          "Ket"]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"KET", "[", "b", "]"}], "->", 
        RowBox[{"SUMK", "[", 
         RowBox[{"j", ",", " ", 
          RowBox[{"USET", "[", "T", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"\[Beta]", "[", "j", "]"}], "~", "SCRK", "~", 
           RowBox[{"u", "[", "j", "]"}]}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"ADJB", "[", 
          RowBox[{"u", "[", "i_", "]"}], "]"}], "~", "DOT", "~", 
         RowBox[{"u", "[", "j_", "]"}]}], "->", 
        RowBox[{"DELTA", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"1599e5c9-0222-4b7f-8d07-d63be531e496"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[8]=",ExpressionUUID->"7e7147ac-66ae-4790-9ba0-6a85710500ac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq4 (CPX sum skipped)", "Subsection",ExpressionUUID->"f239a877-ac55-47d1-90f6-01e309fbd495"],

Cell["notice that 2 pi (delta i) = (lambda i) t0", "Text",ExpressionUUID->"73fe6793-21ad-4ff5-b6ac-1ffc3dfdeeab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"DiracCtx", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "->", "T"}], ",", 
       RowBox[{"M", "->", 
        RowBox[{"SetType", "[", "m", "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "[", "_", "]"}], "->", "SType"}], ",", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "_", "]"}], "->", "SType"}], ",", 
       RowBox[{"b", "->", "T"}], ",", 
       RowBox[{
        RowBox[{"u", "[", "_", "]"}], "->", 
        RowBox[{"KType", "[", "T", "]"}]}], ",", 
       RowBox[{
        RowBox[{"U", "[", "_", "]"}], "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", 
       RowBox[{"Hu", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
       RowBox[{"Uf", "->", 
        RowBox[{"OType", "[", 
         RowBox[{
          RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
          RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", 
       RowBox[{"IQFT", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CPX", "[", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "]"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IQFT", "\[SmallCircle]", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Beta]", "[", "j", "]"}], 
               RowBox[{"CPX", "[", 
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "Pi", " ", "I", " ", "\[Tau]", " ", 
                  RowBox[{
                   RowBox[{"\[Delta]", "[", "\[Tau]", "]"}], " ", "/", 
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
               TemplateBox[{"\[Tau]"},
                "Ket"]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Tau]", ",", 
                RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], 
           "\[CircleTimes]", 
           RowBox[{"u", "[", "j", "]"}]}], ")"}], "\[CircleTimes]", 
         TemplateBox[{"0"},
          "Ket"]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SUMK", "[", 
      RowBox[{
       RowBox[{"IDX", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"USET", "[", "T", "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SUMS", "[", 
           RowBox[{"k", ",", 
            RowBox[{"USET", "[", "T", "]"}], ",", 
            RowBox[{"CPX", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], " ", "I", " ", "Pi", " ", "j", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"k", " ", "-", " ", 
                   RowBox[{"\[Delta]", "[", "j", "]"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "n"}], ")"}]}]}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"1", "+", "n"}], ")"}]}], "]"}]}], "]"}], "~", "MLTS", 
          "~", 
          RowBox[{"\[Beta]", "[", "j", "]"}]}], ")"}], "~", "SCRK", "~", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"KET", "[", "j", "]"}], "~", "TSRK", "~", 
            RowBox[{"u", "[", "i", "]"}]}], ")"}], "~", "TSRK", "~", 
          RowBox[{"KET", "[", "0", "]"}]}], ")"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IQFT", "~", "MLTK", "~", 
        RowBox[{"KET", "[", "i_", "]"}]}], "->", 
       RowBox[{
        RowBox[{"CPX", "[", 
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"n", "+", "1"}], "]"}]}], "]"}], "~", "SCRK", "~", 
        RowBox[{"SUMK", "[", 
         RowBox[{"k", ",", 
          RowBox[{"USET", "[", "T", "]"}], ",", 
          RowBox[{
           RowBox[{"CPX", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], " ", "Pi", " ", "I", " ", "i", " ", 
              RowBox[{"k", " ", "/", " ", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], "~", "SCRK",
            "~", 
           RowBox[{"KET", "[", "k", "]"}]}]}], "]"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"e001811c-5edd-414b-8358-0c2f336ae7d4"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"6aa3a99c-39c7-41ed-a044-bb87d58453fa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq5", "Subsection",ExpressionUUID->"a93d65fa-fe66-4057-b5f7-d4a12ae6fe83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"DiracCtx", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "->", "T"}], ",", 
       RowBox[{"M", "->", 
        RowBox[{"SetType", "[", "m", "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "_", "]"}], "->", "T"}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "[", "_", "]"}], "->", "SType"}], ",", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "_", "]"}], "->", "SType"}], ",", 
       RowBox[{"b", "->", "T"}], ",", 
       RowBox[{
        RowBox[{"u", "[", "_", "]"}], "->", 
        RowBox[{"KType", "[", "T", "]"}]}], ",", 
       RowBox[{
        RowBox[{"U", "[", "_", "]"}], "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", 
       RowBox[{"Hu", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
       RowBox[{"Uf", "->", 
        RowBox[{"OType", "[", 
         RowBox[{
          RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
          RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", 
       RowBox[{"IQFT", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
       RowBox[{"Uc", "->", 
        RowBox[{"OType", "[", 
         RowBox[{
          RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
          RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"v", "[", "_", "]"}], "->", 
        RowBox[{"KType", "[", "T", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "[", "j", "]"}], 
        RowBox[{
         RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{"Uc", "\[SmallCircle]", 
           RowBox[{"(", 
            RowBox[{
             TemplateBox[{
               RowBox[{"\[Delta]", "[", "j", "]"}]},
              "Ket"], "\[CircleTimes]", 
             TemplateBox[{"0"},
              "Ket"]}], ")"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "[", "j", "]"}], 
        RowBox[{
         RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{
             RowBox[{"\[Delta]", "[", "j", "]"}]},
            "Ket"], "\[CircleTimes]", 
           RowBox[{"v", "[", 
            RowBox[{"\[Delta]", "[", "j", "]"}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Uc", "~", "MLTK", "~", 
        RowBox[{"KET", "[", 
         RowBox[{"PAIR", "[", 
          RowBox[{"i_", ",", "0"}], "]"}], "]"}]}], "->", 
       RowBox[{
        RowBox[{"KET", "[", "i", "]"}], "~", "TSRK", "~", 
        RowBox[{"v", "[", "i", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"517f83ee-ee71-40ad-9410-959575555edb"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[10]=",ExpressionUUID->"0f8f66e1-b83d-4f41-8779-8a4a8e79d442"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq6", "Subsubsection",ExpressionUUID->"6bf139c1-d5ea-4e60-b4eb-13b932eae1d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"DiracCtx", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "->", "T"}], ",", 
       RowBox[{"M", "->", 
        RowBox[{"SetType", "[", "m", "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "_", "]"}], "->", "T"}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "[", "_", "]"}], "->", "SType"}], ",", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "_", "]"}], "->", "SType"}], ",", 
       RowBox[{"b", "->", "T"}], ",", 
       RowBox[{
        RowBox[{"u", "[", "_", "]"}], "->", 
        RowBox[{"KType", "[", "T", "]"}]}], ",", 
       RowBox[{
        RowBox[{"U", "[", "_", "]"}], "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", 
       RowBox[{"Hu", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
       RowBox[{"Uf", "->", 
        RowBox[{"OType", "[", 
         RowBox[{
          RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
          RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", 
       RowBox[{"IQFT", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", 
       RowBox[{"QFT", "->", 
        RowBox[{"OType", "[", 
         RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
       RowBox[{"Uc", "->", 
        RowBox[{"OType", "[", 
         RowBox[{
          RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
          RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"v", "[", "_", "]"}], "->", 
        RowBox[{"KType", "[", "T", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "[", "j", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"QFT", "\[SmallCircle]", 
           TemplateBox[{
             RowBox[{"\[Delta]", "[", "j", "]"}]},
            "Ket"]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
           RowBox[{"v", "[", 
            RowBox[{"\[Delta]", "[", "j", "]"}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CPX", "[", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "]"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]", "[", "j", "]"}], 
           RowBox[{"CPX", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "2", " ", "Pi", " ", 
              RowBox[{"\[Delta]", "[", "j", "]"}], " ", 
              RowBox[{"\[Tau]", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", "n"}], ")"}]}]}], "]"}], "]"}], 
           RowBox[{
            TemplateBox[{"\[Tau]"},
             "Ket"], "\[CircleTimes]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
              RowBox[{"v", "[", "j", "]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", 
          RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"QFT", "~", "MLTK", "~", 
        RowBox[{"KET", "[", "i_", "]"}]}], "->", 
       RowBox[{
        RowBox[{"CPX", "[", 
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"n", "+", "1"}], "]"}]}], "]"}], "~", "SCRK", "~", 
        RowBox[{"SUMK", "[", 
         RowBox[{"k", ",", 
          RowBox[{"USET", "[", "T", "]"}], ",", 
          RowBox[{
           RowBox[{"CPX", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "Pi", " ", "I", " ", "i", " ", 
              RowBox[{"k", " ", "/", " ", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], "~", "SCRK",
            "~", 
           RowBox[{"KET", "[", "k", "]"}]}]}], "]"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"098e79e4-a0c2-449a-8bab-e07938622bbe"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[11]=",ExpressionUUID->"be82d01f-5cb3-4694-aa21-d47c94b6983d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq7", "Subsubsection",ExpressionUUID->"3f58797c-d415-4109-b13b-10a5c836f229"],

Cell["Note that the isomorphism is needed here.", "Text",ExpressionUUID->"b09c47f7-1869-468b-9946-79b715c6dfc5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DiracCtx", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "->", "T"}], ",", 
        RowBox[{"M", "->", 
         RowBox[{"SetType", "[", "m", "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Delta]", "[", "_", "]"}], "->", "T"}], ",", 
        RowBox[{
         RowBox[{"\[Beta]", "[", "_", "]"}], "->", "SType"}], ",", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "_", "]"}], "->", "SType"}], ",", 
        RowBox[{"b", "->", "T"}], ",", 
        RowBox[{
         RowBox[{"u", "[", "_", "]"}], "->", 
         RowBox[{"KType", "[", "T", "]"}]}], ",", 
        RowBox[{
         RowBox[{"U", "[", "_", "]"}], "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", 
        RowBox[{"Hu", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
        RowBox[{"Uf", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
           RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", 
        RowBox[{"IQFT", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", 
        RowBox[{"QFT", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
        RowBox[{"Uc", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
           RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"v", "[", "_", "]"}], "->", 
         RowBox[{"KType", "[", "T", "]"}]}], ",", 
        RowBox[{"isomorphism", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", 
            RowBox[{"(", 
             RowBox[{"T", "~", "ProdType", "~", "T"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"T", "~", "ProdType", "~", "T"}], ")"}], "~", "ProdType",
             "~", "T"}]}], "]"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Uf", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "=", 
           RowBox[{"Unique", "[", "]"}]}], ",", 
          RowBox[{"j", "=", 
           RowBox[{"Unique", "[", "]"}]}]}], "}"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             TemplateBox[{"i"},
              "Ket"], "\[CircleTimes]", 
             TemplateBox[{"i"},
              "Bra"]}], ")"}], "\[CircleTimes]", 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"CPX", "[", 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", "i", " ", 
                  RowBox[{"\[Lambda]", "[", "j", "]"}], " ", 
                  RowBox[{
                   RowBox[{"t0", "[", "j", "]"}], " ", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
                 RowBox[{"(", 
                  SuperscriptBox[
                   RowBox[{"u", "[", "j", "]"}], "\[Dagger]"], ")"}]}], 
                ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"isomorphism", "=", 
      RowBox[{"SUMO", "[", 
       RowBox[{
        RowBox[{"IDX", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"KET", "[", 
          RowBox[{"PAIR", "[", 
           RowBox[{"a", ",", 
            RowBox[{"PAIR", "[", 
             RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "]"}], "~", "OUTER", 
         "~", 
         RowBox[{"BRA", "[", 
          RowBox[{"PAIR", "[", 
           RowBox[{
            RowBox[{"PAIR", "[", 
             RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", "LHS"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LHS", "=", 
     RowBox[{
      RowBox[{"DNNorm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"CPX", "[", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"n", "+", "1"}], "]"}]}], "]"}], " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Beta]", "[", "j", "]"}], 
              RowBox[{"CPX", "[", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "2", " ", "Pi", " ", 
                 RowBox[{"\[Delta]", "[", "j", "]"}], " ", 
                 RowBox[{"\[Tau]", "/", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "n"}], ")"}]}]}], "]"}], "]"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Uf", "\[Dagger]"], "\[SmallCircle]", 
                 RowBox[{"(", 
                  RowBox[{
                   TemplateBox[{"\[Tau]"},
                    "Ket"], "\[CircleTimes]", 
                   RowBox[{"u", "[", "j", "]"}]}], ")"}]}], ")"}], 
               "\[CircleTimes]", 
               RowBox[{"v", "[", "j", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Tau]", ",", 
             RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ADJB", "[", 
             RowBox[{"u", "[", "i_", "]"}], "]"}], "~", "DOT", "~", 
            RowBox[{"u", "[", "j_", "]"}]}], "->", 
           RowBox[{"DELTA", "[", 
            RowBox[{"i", ",", " ", "j"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]", "[", "j_", "]"}], " ", 
            RowBox[{"t0", "[", "j_", "]"}]}], "->", 
           RowBox[{"2", " ", "Pi", " ", 
            RowBox[{"\[Delta]", "[", "j", "]"}]}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{
       RowBox[{"Exp", "[", "_", "]"}], "->", "1"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"isomorphism", "\[SmallCircle]", "LHS"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CPX", "[", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"n", "+", "1"}], "]"}]}], "]"}], 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          TemplateBox[{"\[Tau]"},
           "Ket"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], 
        "\[CircleTimes]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]", "[", "j", "]"}], " ", 
           RowBox[{
            RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
            RowBox[{"v", "[", "j", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 CellLabel->"In[12]:=",ExpressionUUID->"306e20ce-651e-41bd-a0fe-e695401f6dcb"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[12]=",ExpressionUUID->"f2834e03-01ed-4bce-8434-4ba16cff38c3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq8", "Subsubsection",ExpressionUUID->"3ba35994-9571-4761-9e89-14f5436f5dad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DiracCtx", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "->", "T"}], ",", 
        RowBox[{"M", "->", 
         RowBox[{"SetType", "[", "m", "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Delta]", "[", "_", "]"}], "->", "T"}], ",", 
        RowBox[{
         RowBox[{"\[Beta]", "[", "_", "]"}], "->", "SType"}], ",", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "_", "]"}], "->", "SType"}], ",", 
        RowBox[{"b", "->", "T"}], ",", 
        RowBox[{
         RowBox[{"u", "[", "_", "]"}], "->", 
         RowBox[{"KType", "[", "T", "]"}]}], ",", 
        RowBox[{
         RowBox[{"U", "[", "_", "]"}], "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", 
        RowBox[{"Hn", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
        RowBox[{"Uf", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
           RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", 
        RowBox[{"IQFT", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", 
        RowBox[{"QFT", "->", 
         RowBox[{"OType", "[", 
          RowBox[{"T", ",", "T"}], "]"}]}], ",", " ", 
        RowBox[{"Uc", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", "T"}], ",", " ", 
           RowBox[{"T", "~", "ProdType", "~", "T"}]}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"v", "[", "_", "]"}], "->", 
         RowBox[{"KType", "[", "T", "]"}]}], ",", 
        RowBox[{"isomorphism", "->", 
         RowBox[{"OType", "[", 
          RowBox[{
           RowBox[{"T", "~", "ProdType", "~", 
            RowBox[{"(", 
             RowBox[{"T", "~", "ProdType", "~", "T"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"T", "~", "ProdType", "~", "T"}], ")"}], "~", "ProdType",
             "~", "T"}]}], "]"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Uf", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "=", 
           RowBox[{"Unique", "[", "]"}]}], ",", 
          RowBox[{"j", "=", 
           RowBox[{"Unique", "[", "]"}]}]}], "}"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             TemplateBox[{"i"},
              "Ket"], "\[CircleTimes]", 
             TemplateBox[{"i"},
              "Bra"]}], ")"}], "\[CircleTimes]", 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"CPX", "[", 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", "i", " ", 
                  RowBox[{"\[Lambda]", "[", "j", "]"}], " ", 
                  RowBox[{
                   RowBox[{"t0", "[", "j", "]"}], " ", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
                 RowBox[{"(", 
                  SuperscriptBox[
                   RowBox[{"u", "[", "j", "]"}], "\[Dagger]"], ")"}]}], 
                ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"isomorphism", "=", 
      RowBox[{"SUMO", "[", 
       RowBox[{
        RowBox[{"IDX", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"KET", "[", 
          RowBox[{"PAIR", "[", 
           RowBox[{"a", ",", 
            RowBox[{"PAIR", "[", 
             RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "]"}], "~", "OUTER", 
         "~", 
         RowBox[{"BRA", "[", 
          RowBox[{"PAIR", "[", 
           RowBox[{
            RowBox[{"PAIR", "[", 
             RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", "LHS"}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DNEqQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CPX", "[", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Hn", "\[Dagger]"], "\[SmallCircle]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           TemplateBox[{"\[Tau]"},
            "Ket"], ",", 
           RowBox[{"{", 
            RowBox[{"\[Tau]", ",", 
             RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}], ")"}], 
       "\[CircleTimes]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]", "[", "j", "]"}], " ", 
          RowBox[{
           RowBox[{"u", "[", "j", "]"}], "\[CircleTimes]", 
           RowBox[{"v", "[", "j", "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "[", "i", "]"}], 
        RowBox[{
         TemplateBox[{"0"},
          "Ket"], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", "[", "i", "]"}], "\[CircleTimes]", 
           RowBox[{"v", "[", "i", "]"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"USET", "[", "T", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ADJO", "[", "Hn", "]"}], "~", "MLTK", "~", 
        RowBox[{"SUMK", "[", 
         RowBox[{
          RowBox[{"IDX", "[", 
           RowBox[{"{", 
            RowBox[{"i_", ",", 
             RowBox[{"USET", "[", "T", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"KET", "[", "i_", "]"}]}], "]"}]}], ":>", 
       RowBox[{
        RowBox[{"CPX", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "]"}], "~", "SCRK", "~", 
        RowBox[{"KET", "[", "0", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"faa07c4d-b967-4527-bc5c-6e8c06d1f958"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[13]=",ExpressionUUID->"1fd9a612-06d0-4505-b9fe-b2b77e5f7d1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"endTime", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runningTime", "=", 
   RowBox[{"endTime", "-", "startTime"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Total running time: \>\"", ",", "runningTime", ",", 
    "\"\< seconds\>\""}], "]"}], ";"}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"c0b46d6b-0c23-4b20-ab73-8434c36a852e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total running time: \"\>", "\[InvisibleSpace]", 
   "1.339667`6.578541853028665", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Total running time: ", 1.339667`6.578541853028665, " seconds"],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"71db8be2-5c2a-4c72-b016-589425110916"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1416, 897},
WindowMargins->{{Automatic, 55}, {-221, Automatic}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"853d6620-0193-4703-b678-84b6452c7868"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 85, 0, 98, "Title",ExpressionUUID->"c6575417-f821-4098-9059-ae47604f6e12"],
Cell[668, 24, 402, 10, 72, "Code",ExpressionUUID->"cdcd0075-d750-441f-83d0-24537a94534c"],
Cell[1073, 36, 83, 0, 35, "Text",ExpressionUUID->"ded6d6f1-e910-48d3-88d6-cda40782a4dd"],
Cell[1159, 38, 188, 4, 30, "Input",ExpressionUUID->"cfd78e22-c41f-485f-94ae-081624387523"],
Cell[CellGroupData[{
Cell[1372, 46, 80, 0, 54, "Subsection",ExpressionUUID->"cbbcd56c-6a36-4942-934f-dc466215fb89"],
Cell[CellGroupData[{
Cell[1477, 50, 1554, 45, 256, "Input",ExpressionUUID->"4ba4b617-838d-4ef4-bd56-d0434b6cf47f"],
Cell[3034, 97, 109, 1, 34, "Output",ExpressionUUID->"e051a325-d536-4547-85b8-0c141467b3b0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3192, 104, 80, 0, 54, "Subsection",ExpressionUUID->"5a808bf5-f7a0-4088-97c6-9bd8353724e5"],
Cell[CellGroupData[{
Cell[3297, 108, 2396, 68, 256, "Input",ExpressionUUID->"0d43fb5d-cf52-420a-a9e5-a8347b3271f8"],
Cell[5696, 178, 109, 1, 34, "Output",ExpressionUUID->"abab414e-1a8a-4a6f-b47a-f5b69476a8d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5854, 185, 80, 0, 54, "Subsection",ExpressionUUID->"37a7088d-33fc-488d-8a2f-1a66e5d6c7a5"],
Cell[CellGroupData[{
Cell[5959, 189, 5213, 143, 284, "Input",ExpressionUUID->"1599e5c9-0222-4b7f-8d07-d63be531e496"],
Cell[11175, 334, 109, 1, 34, "Output",ExpressionUUID->"7e7147ac-66ae-4790-9ba0-6a85710500ac"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11333, 341, 98, 0, 54, "Subsection",ExpressionUUID->"f239a877-ac55-47d1-90f6-01e309fbd495"],
Cell[11434, 343, 113, 0, 35, "Text",ExpressionUUID->"73fe6793-21ad-4ff5-b6ac-1ffc3dfdeeab"],
Cell[CellGroupData[{
Cell[11572, 347, 5076, 133, 273, "Input",ExpressionUUID->"e001811c-5edd-414b-8358-0c2f336ae7d4"],
Cell[16651, 482, 109, 1, 34, "Output",ExpressionUUID->"6aa3a99c-39c7-41ed-a044-bb87d58453fa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16809, 489, 80, 0, 54, "Subsection",ExpressionUUID->"a93d65fa-fe66-4057-b5f7-d4a12ae6fe83"],
Cell[CellGroupData[{
Cell[16914, 493, 3451, 92, 277, "Input",ExpressionUUID->"517f83ee-ee71-40ad-9410-959575555edb"],
Cell[20368, 587, 110, 1, 34, "Output",ExpressionUUID->"0f8f66e1-b83d-4f41-8779-8a4a8e79d442"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20515, 593, 83, 0, 45, "Subsubsection",ExpressionUUID->"6bf139c1-d5ea-4e60-b4eb-13b932eae1d5"],
Cell[CellGroupData[{
Cell[20623, 597, 4640, 122, 277, "Input",ExpressionUUID->"098e79e4-a0c2-449a-8bab-e07938622bbe"],
Cell[25266, 721, 110, 1, 34, "Output",ExpressionUUID->"be82d01f-5cb3-4694-aa21-d47c94b6983d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25425, 728, 83, 0, 45, "Subsubsection",ExpressionUUID->"3f58797c-d415-4109-b13b-10a5c836f229"],
Cell[25511, 730, 112, 0, 35, "Text",ExpressionUUID->"b09c47f7-1869-468b-9946-79b715c6dfc5"],
Cell[CellGroupData[{
Cell[25648, 734, 8267, 220, 434, "Input",ExpressionUUID->"306e20ce-651e-41bd-a0fe-e695401f6dcb"],
Cell[33918, 956, 110, 1, 34, "Output",ExpressionUUID->"f2834e03-01ed-4bce-8434-4ba16cff38c3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34077, 963, 83, 0, 45, "Subsubsection",ExpressionUUID->"3ba35994-9571-4761-9e89-14f5436f5dad"],
Cell[CellGroupData[{
Cell[34185, 967, 7086, 192, 368, "Input",ExpressionUUID->"faa07c4d-b967-4527-bc5c-6e8c06d1f958"],
Cell[41274, 1161, 110, 1, 34, "Output",ExpressionUUID->"1fd9a612-06d0-4505-b9fe-b2b77e5f7d1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41421, 1167, 470, 12, 73, "Input",ExpressionUUID->"c0b46d6b-0c23-4b20-ab73-8434c36a852e"],
Cell[41894, 1181, 388, 8, 24, "Print",ExpressionUUID->"71db8be2-5c2a-4c72-b016-589425110916"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

